# 要求定義書 作成プロセス定義書
（01_stakeholder-needs.md 運用ルール）

本書は **要求定義の"作成プロセス"を詳細に定義する正式文書**である。
目的は以下の2点に絞る。

1. **要求の曖昧さ・漏れ・誤解を排除し、後工程の手戻りを最小化する**
2. **Stakeholder Needs テンプレートを統一的に運用できるようにする**

---

# 0. 固定テンプレート構造（厳守）

**出力先**: `docs/requirements/01_stakeholder-needs.md`

要求定義書のテンプレート構造は以下の通りである。

```markdown
# 01. Stakeholder Needs

## 1. Purpose
## 2. Scope
### 2.1 In Scope
### 2.2 Out of Scope
## 3. Stakeholder List
## 4. Stakeholder Needs
### 4.x <Stakeholder Name>
#### STK-xxx: <要求タイトル>
## 5. Constraints
## 6. Assumptions
## 7. Open Questions
## 8. Appendix
```

**絶対遵守事項**:
- **見出し構造（#, ##, ###, ####）は絶対に変更してはならない**
- 見出しの追加・削除・順序変更は禁止
- 内容のみを記入すること

**参照テンプレート**: `手作業/テンプレート/要求定義書.md`

---

# 1. プロセス全体フロー（厳守）

要求定義書作成は以下のフローで進める。

## 前作業（ヒアリング - 極めて重要）
1. **ヒアリング準備（質問設計）**
2. **ヒアリング実施（生データ取得）**
3. **ヒアリングメモ整理（初期タグ付け）**

## テンプレート記述作業
4. **【テンプレート 3】 Stakeholder List の作成**
5. **【テンプレート 4】 Stakeholder Needs の分類・要求マッピング**
6. **【テンプレート 1】 Purpose の確定**
7. **【テンプレート 2】 Scope の確定**
8. **【テンプレート 5】 Constraints の抽出**
9. **【テンプレート 6】 Assumptions の明確化**
10. **【テンプレート 7】 Open Questions の整理**
11. **【テンプレート 8】 Appendix の整備**

## 最終作業
12. **レビュー・版管理**

工程を飛ばしてはならない。
特に **ヒアリング段階の質問設計の手抜きと Open Questions の漏れは後工程の手戻りの主原因**。

---

# 2. ヒアリング準備（前作業 - 極めて重要）

## 2.1 目的
要求定義の成否は **ヒアリング準備の質で9割決まる**。
質問カテゴリを事前に設計し、漏れ・曖昧さを防ぐ。

## 2.2 必ず準備すべき質問カテゴリ
- **ビジネス目的**（目的・価値）
- **現行業務の課題**（何が困っているか）
- **利用者・関係者の特定**（誰が使うか、誰が影響を受けるか）
- **業務上のリスク・懸念**（失敗したら何が起きるか）
- **システム境界**（やる/やらない）
- **運用フロー**（誰が使うか、運用責任はどこか）
- **技術的制約の有無**（既存システム、技術スタック）
- **成功指標**（成功とは何か、どう測るか）

## 2.3 禁止事項
- **機能の話を先に聞かない**
  - 機能は要件定義フェーズで抽出する。要求定義では「なぜそれが必要か」を聞く
- **「要件」「機能」を要求として扱わない**
  - 「〇〇機能がほしい」は要求ではなく、「なぜ〇〇したいのか」が要求
- **利害調整を後回しにしない**
  - 部門間の利害がぶつかる点はその場で深掘りする

---

# 3. ヒアリング実施（前作業 - 極めて重要）

## 3.1 目的
生の情報を収集し、**言葉の裏にある前提・期待・懸念**を引き出す。

## 3.2 記録方法
- **議事録形式で記録**
- **感情・愚痴・曖昧表現もすべて残す**
  - 「今のツールは使いにくい」→ 何が使いにくいのか、どう困っているのかを詳細に記録
- **その場で疑問は詰める**
  - 後回しは手戻りの原因。曖昧なまま進めない

## 3.3 観点
- **「言ったこと」より「言わなかった前提」に注目する**
  - 「当たり前」と思っていることが後で問題になる
- **部門間の利害がぶつかる点はその場で深掘りする**
  - 要求の対立は早期に明らかにする

## 3.4 記録例
```markdown
【ヒアリング議事録】
日時: 2025-12-01 14:00-15:30
参加者: 営業部 田中氏、システム部 山田氏

[GOAL] 営業部: 顧客データを一元管理したい
[ISSUE] 営業部: 現在はExcelで管理しており、重複・漏れが多発
[STKH] 営業部 田中氏（営業担当者）
[STKH] システム部 山田氏（保守担当）
[REQ] 営業部: 顧客情報の重複チェックが自動化されてほしい
[CONST] 技術制約: 既存の基幹システム（SAP）との連携が必須
[?] 顧客データの更新頻度は？ → 田中氏に確認
[?] SAP連携のAPI仕様は？ → 山田氏に確認
```

---

# 4. ヒアリングメモ整理（前作業 - 極めて重要）

## 4.1 目的
ヒアリングメモを構造化し、**要求・要件・機能の混在を防ぐ**。

## 4.2 タグ付けルール
ヒアリングメモの各行に以下のタグを付与する。

```
[ISSUE]  現行の課題
[GOAL]   目的・期待価値
[STKH]   ステークホルダー候補
[REQ]    要求の種
[RISK]   リスク・懸念
[CONST]  制約
[?]      不明点
```

## 4.3 タグ付け例
```markdown
[GOAL] 営業部: 顧客データを一元管理したい
[ISSUE] 営業部: 現在はExcelで管理しており、重複・漏れが多発
[STKH] 営業部 田中氏（営業担当者）
[REQ] 営業部: 顧客情報の重複チェックが自動化されてほしい
[CONST] 技術制約: 既存の基幹システム（SAP）との連携が必須
[?] 顧客データの更新頻度は？
```

## 4.4 注意点
- **要求・要件・機能が混ざるのを防ぐ**
  - 「〇〇機能がほしい」は要件・機能であり、要求ではない。要求は「なぜそれが必要か」
  - 要件・機能は Constraints に記載しておき、次ステップ（要件定義）に委譲する
- **Stakeholder Needs の構造化作業を効率化する**
  - タグ付けにより、後続の作業が大幅に効率化される

---

# 5. 【テンプレート 3. Stakeholder List】作成プロセス

## 5.1 テンプレート構造
```markdown
## 3. Stakeholder List
| ID | Stakeholder | 役割 / 関心事 |
|----|-------------|----------------|
（ヒアリング内容から抽出し、STKH-xxx として列挙）
```

## 5.2 抽出対象
- **実際に使うユーザ**
- **データを扱う担当者**
- **決裁者（権限保持者）**
- **保守担当**
- **外部システム提供者**

## 5.3 記載ルール
| 項目 | 記述内容 |
|------|----------|
| ID | STKH-001, STKH-002, ... |
| Stakeholder | 明確な個別役割（"利用者"や"システム部門"のような抽象化は禁止） |
| 役割・関心事 | そのステークホルダーが何を気にしているか |

## 5.4 記述例
```markdown
| ID | Stakeholder | 役割 / 関心事 |
|----|-------------|----------------|
| STKH-001 | 営業担当者 | 顧客情報の迅速な登録・検索、重複防止 |
| STKH-002 | 営業マネージャー | 売上予測、顧客分析レポート |
| STKH-003 | システム管理者 | データバックアップ、障害対応 |
| STKH-004 | 経理担当者 | 顧客情報と請求情報の整合性 |
```

## 5.5 禁止事項
- **抽象的な役割名を使わない**
  - NG: "利用者"、"システム部門"
  - OK: "営業担当者"、"システム管理者"

---

# 6. 【テンプレート 1. Purpose】作成プロセス

## 6.1 テンプレート構造
```markdown
## 1. Purpose
（ヒアリング内容から目的を抽出し、1〜3 行で要約する）
- 本システムのビジネス目的
- 解決したい課題
- 期待される価値（Value Proposition）
```

## 6.2 作成手順
1. ヒアリングメモから `[GOAL]` タグを抽出
2. 全ステークホルダー要求の上位目的を 1〜3 行でまとめる
3. **機能の説明は入れない**

## 6.3 記述例
```markdown
## 1. Purpose
- **ビジネス目的**: 営業部門の顧客情報管理を一元化し、重複・漏れを防止する
- **解決したい課題**: 現在はExcelで管理しており、データの重複・漏れが多発。営業効率が低下している
- **期待される価値**: 顧客情報の正確性向上、営業活動の効率化、売上予測精度の向上
```

## 6.4 禁止事項
- **機能の説明を入れない**
  - NG: "顧客情報を登録・検索できる機能"
  - OK: "顧客情報の一元管理により営業効率を向上"

---

# 7. 【テンプレート 2. Scope】作成プロセス

## 7.1 テンプレート構造
```markdown
## 2. Scope
### 2.1 In Scope
（対象とする範囲を列挙する）
### 2.2 Out of Scope
（対象外の範囲があれば補完する）
```

## 7.2 In Scope の決定基準
- **やる理由が明確で価値があるもの**
- ステークホルダーが明確に要求しているもの
- ビジネス目的に直結するもの

## 7.3 Out of Scope の決定基準
- **利用者/価値が曖昧なもの**
- **不明なものは Out に振り、Open Questions に送る**
- 将来的に必要だが、初期リリースには不要なもの

## 7.4 記述例
```markdown
## 2. Scope
### 2.1 In Scope
- 顧客情報の登録・検索・更新・削除
- 顧客情報の重複チェック
- 既存の基幹システム（SAP）との連携
- 売上予測レポートの生成

### 2.2 Out of Scope
- 顧客との契約管理（別システムで対応）
- マーケティングオートメーション（将来検討）
- モバイルアプリ対応（初期リリースでは不要）
```

---

# 8. 【テンプレート 4. Stakeholder Needs】作成プロセス

## 8.1 テンプレート構造
```markdown
## 4. Stakeholder Needs
ステークホルダー単位で要求を分類し、以下の構造に従って必ず記述する。

### 4.x <Stakeholder Name>
#### STK-xxx: <要求タイトル>
**概要**
（要求の要点を 1 行で要約）

**詳細**
- ユースケース
- 背景
- 懸念・不満点
- 必要とされる理由

**受入条件**
- 条件1
- 条件2

**関連ステークホルダー**
- STKH-xxx

**優先度**
MUST / SHOULD / COULD / WON'T より選択
```

## 8.2 要求の変換ルール
ヒアリングの断片をそのまま書かず、以下のように変換する。

| メモ断片 | 変換後に記述するべき要求 |
|----------|----------------------------|
| 〇〇できる画面がほしい | なぜ〇〇したいのか（目的・理由） |
| 今のツールは遅い | 遅いことで発生している業務影響 |
| Excelで管理している | Excelで管理せざるを得ない事情（背景） |

## 8.3 4.x セクション作成手順
1. Stakeholder List から1名を選ぶ
2. その人に関する `[REQ]` タグをすべて収集
3. 意味のまとまりごとに分類する
4. 要求タイトル（STK-xxx: ～）を作成
5. **概要 → 詳細 → 受入条件 → 関連STKH → 優先度** の順に埋める

## 8.4 受入条件の書き方
- **定量化する**（速度・形式・件数・操作ステップなど）
- **行動ではなく「観察可能な結果」で書く**
- **抽象語（"簡単に""スムーズに"）は禁止**

## 8.5 記述例
```markdown
### 4.1 営業担当者（STKH-001）

#### STK-001: 顧客情報の重複を防止したい
**概要**
顧客情報の登録時に重複をチェックし、誤った顧客データの登録を防ぎたい。

**詳細**
- **ユースケース**: 営業担当者が新規顧客を登録する際、既存の顧客と重複していないかを確認する
- **背景**: 現在はExcelで管理しており、同じ顧客が複数回登録されることがある
- **懸念・不満点**: 重複により、顧客への二重請求や営業活動の重複が発生
- **必要とされる理由**: 顧客情報の正確性を保ち、営業効率を向上させるため

**受入条件**
- 顧客名・電話番号・メールアドレスのいずれかが一致する場合、警告が表示される
- 重複チェックは登録ボタン押下から3秒以内に完了する
- 重複候補が表示され、営業担当者が確認できる

**関連ステークホルダー**
- STKH-002（営業マネージャー）

**優先度**
MUST
```

---

# 9. 【テンプレート 5. Constraints】作成プロセス

## 9.1 テンプレート構造
```markdown
## 5. Constraints
- 技術的制約
- 運用制約
- 外部依存
（ヒアリングに無い場合は空欄ではなく "情報不足、要確認" と記述）
```

## 9.2 記載すべき項目
- **技術制約**（例：既存APIの仕様、利用言語の強制）
- **データ制約**（例：フォーマット固定）
- **運用制約**（例：担当部署・稼働時間）
- **外部依存**（例：他システムとの連携）
- **規制・セキュリティ制約**

## 9.3 情報不足時のルール
- **空欄禁止**
- **「情報不足、要確認（理由）」と記載する**

## 9.4 記述例
```markdown
## 5. Constraints
- **技術的制約**:
  - 既存の基幹システム（SAP）との連携が必須。SAP APIの仕様に準拠する必要がある
  - 開発言語: Python 3.10 以降（既存システムとの整合性）
- **データ制約**:
  - 顧客データのフォーマットは SAP の標準フォーマットに準拠
  - 個人情報保護のため、暗号化必須
- **運用制約**:
  - 運用時間: 平日 9:00-18:00（営業部門の稼働時間）
  - 保守担当: システム部 山田氏
- **外部依存**:
  - SAP API の可用性に依存
  - 情報不足、要確認（SAP API のダウンタイム頻度）
- **規制・セキュリティ制約**:
  - 個人情報保護法に準拠
  - アクセスログの保存期間: 1年
```

---

# 10. 【テンプレート 6. Assumptions】作成プロセス

## 10.1 テンプレート構造
```markdown
## 6. Assumptions
（前提条件を抽出し、不足がある場合は "要確認（理由）" と明記）
```

## 10.2 抽出基準
- **要求が成立するために必要な前提**
- **業務フローの固定**
- **他システムの仕様固定**
- **利用者の習熟度前提** など

## 10.3 不明点の書き方
- **「要確認（理由）」で必ず明記する**

## 10.4 記述例
```markdown
## 6. Assumptions
- 営業担当者は全員 PC 操作に習熟している（Excel の基本操作ができる）
- SAP API の仕様は変更されない前提（変更時は再設計が必要）
- 顧客データは営業部門が一元管理する（経理部門は参照のみ）
- 要確認（インターネット接続環境の有無）
- 要確認（営業担当者の同時アクセス数）
```

---

# 11. 【テンプレート 7. Open Questions】作成プロセス

## 11.1 テンプレート構造
```markdown
## 7. Open Questions
不明点や曖昧な部分を必ずここに列挙すること。
- 質問内容
- 誰に確認すべきか
- 影響範囲
```

## 11.2 記載項目
- **質問内容**（何が不明か）
- **誰に確認するか**（Stakeholder ID）
- **解決しない場合の影響**
- **解決期限**（レビュー前・設計前など）

## 11.3 禁止事項
- **ただ「未定」と書く**
- **重要度の記載なし**
- **担当者不明**

## 11.4 記述例
```markdown
## 7. Open Questions
| ID | 質問内容 | 確認先 | 影響範囲 | 解決期限 |
|----|----------|--------|----------|----------|
| Q-001 | 顧客データの更新頻度は？ | STKH-001（営業担当者） | データ同期設計に影響 | レビュー前 |
| Q-002 | SAP API のダウンタイム頻度は？ | STKH-003（システム管理者） | 可用性設計に影響 | 設計前 |
| Q-003 | 営業担当者の同時アクセス数は？ | STKH-002（営業マネージャー） | 性能設計に影響 | 設計前 |
| Q-004 | インターネット接続環境はあるか？ | STKH-003（システム管理者） | アーキテクチャ選定に影響 | アーキテクチャ検討前 |
```

---

# 12. 【テンプレート 8. Appendix】作成プロセス

## 12.1 テンプレート構造
```markdown
## 8. Appendix
- 元ヒアリングメモ要約
- 関連図や補足があれば記載
```

## 12.2 内容
- **元ヒアリングメモ要約**
- **業務フロー図**
- **システム境界図**
- **用語定義集**

## 12.3 記述例
```markdown
## 8. Appendix

### 元ヒアリングメモ要約
【ヒアリング議事録】
日時: 2025-12-01 14:00-15:30
参加者: 営業部 田中氏、システム部 山田氏

[GOAL] 営業部: 顧客データを一元管理したい
[ISSUE] 営業部: 現在はExcelで管理しており、重複・漏れが多発
...

### 業務フロー図
（Mermaid diagram などで記載）

### 用語定義集
| 用語 | 定義 |
|------|------|
| 顧客 | 営業部門が管理する取引先企業・個人 |
| 重複チェック | 顧客名・電話番号・メールアドレスの一致判定 |
```

---

# 13. レビュー & 版管理

## 13.1 レビュー観点
- **要求が Why で書かれているか**
  - 「〇〇機能がほしい」ではなく「なぜ〇〇したいのか」
- **Stakeholder と Needs が一意に紐づいているか**
  - 各要求が明確なステークホルダーに紐づいている
- **受入条件が定量化されているか**
  - 抽象的な表現（"簡単に""スムーズに"）がない
- **Open Questions が十分に整理されているか**
  - 不明点が明確に記載され、確認先・期限が明記されている
- **Scope が適正か（広げすぎていないか）**
  - In Scope / Out of Scope が明確に分離されている

## 13.2 バージョン管理ルール
- **テンプレート内に履歴は書かない**
- **Git / Confluence のページ履歴で管理する**
- **Pull Request ベースで差分を明確に残す**

## 13.3 チェックリスト
- [ ] **テンプレート構造が厳守されているか**（見出し構造の変更・削除・追加がないか）
- [ ] すべてのステークホルダーが Stakeholder List に列挙されているか
- [ ] 各 Stakeholder Needs が「概要・詳細・受入条件・関連STKH・優先度」を含むか
- [ ] Purpose / Scope が明確か
- [ ] Constraints が具体的に記載されているか（空欄がないか）
- [ ] Assumptions が明確か（不明点は "要確認" と記載されているか）
- [ ] Open Questions が整理されているか（確認先・期限が明記されているか）
- [ ] Appendix に元ヒアリングメモが含まれているか

---

# まとめ（重要ポイント）

- **ヒアリング準備・実施・整理が要求定義の成否を9割決める**
- **要求・要件・機能を混同しない**（要求は "Why"、要件・機能は "What/How"）
- **テンプレート構造を厳守** し、見出し構造を変更しない
- **受入条件は定量化** し、抽象的な表現を避ける
- **Open Questions を必ず整理** し、後工程の手戻りを防ぐ
- **Stakeholder Needs は「概要・詳細・受入条件・関連STKH・優先度」を必ず含む**
- **情報不足の場合は空欄にせず「要確認（理由）」と明記する**
